<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Importação de Contas (Versão Corrigida)</title>
</head>
<body>
    <h1>Importador do Plano de Contas Padrão</h1>
    <p>Abra o console (F12) para ver o progresso.</p>
    <button id="start-import">Iniciar Importação Manual</button>
    <div id="status"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // --- COLOQUE SUAS CREDENCIAIS AQUI ---
        const supabaseUrl = 'https://kubvqfjfgvwuqrtbdlvj.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1YnZxZmpmZ3Z3dXFydGJkbHZqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwMjE0NDgsImV4cCI6MjA3NDU5NzQ0OH0.aXAnxDJr0MfipEsIg1tnRDb6DCxFbDOVkwIT0rjXu50';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        // Dados extraídos e corrigidos da sua planilha "setup.csv"
        // Dentro de importar-contas.html, substitua o array 'contasPadrao'

const contasPadrao = [
    { "grupo": 1, "sub_grupo": 1, "elemento": 1, "codigo": "1.1.1", "nome": "Caixa", "classificacao": "Ativo Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 1, "elemento": 2, "codigo": "1.1.2", "nome": "Banco", "classificacao": "Ativo Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 1, "elemento": 3, "codigo": "1.1.3", "nome": "Contas a Receber", "classificacao": "Ativo Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 1, "elemento": 4, "codigo": "1.1.4", "nome": "Mercadorias", "classificacao": "Ativo Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 1, "elemento": 5, "codigo": "1.1.5", "nome": "Despesas Antecipadas", "classificacao": "Ativo Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 1, "elemento": 6, "codigo": "1.1.6", "nome": "Impostos a Recuperar", "classificacao": "Ativo Circulante", "natureza": 1, "tipo": "A" },

    { "grupo": 1, "sub_grupo": 2, "elemento": 1, "codigo": "1.2.1", "nome": "Contas a Receber LP", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 2, "codigo": "1.2.2", "nome": "Terrenos - Investimento", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 3, "codigo": "1.2.3", "nome": "Obra de Arte", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 4, "codigo": "1.2.4", "nome": "Móveis e Utensílios", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 5, "codigo": "1.2.5", "nome": "Banco investimento", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 6, "codigo": "1.2.6", "nome": "Máquinas e Equipamentos", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 7, "codigo": "1.2.7", "nome": "Imóveis", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 8, "codigo": "1.2.8", "nome": "Veículos", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 9, "codigo": "1.2.9", "nome": "Terrenos - Imobilizado", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 10, "codigo": "1.2.10", "nome": "Depreciação Acumulada", "classificacao": "Ativo Não Circulante", "natureza": -1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 11, "codigo": "1.2.11", "nome": "Marcas e Patentes", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },
    { "grupo": 1, "sub_grupo": 2, "elemento": 12, "codigo": "1.2.12", "nome": "Software", "classificacao": "Ativo Não Circulante", "natureza": 1, "tipo": "A" },

    { "grupo": 2, "sub_grupo": 1, "elemento": 1, "codigo": "2.1.1", "nome": "Contas a Pagar", "classificacao": "Passivo Circulante", "natureza": -1, "tipo": "A" },
    { "grupo": 2, "sub_grupo": 1, "elemento": 2, "codigo": "2.1.2", "nome": "Fornecedores", "classificacao": "Passivo Circulante", "natureza": -1, "tipo": "A" },
    { "grupo": 2, "sub_grupo": 1, "elemento": 3, "codigo": "2.1.3", "nome": "Impostos a Pagar", "classificacao": "Passivo Circulante", "natureza": -1, "tipo": "A" },
    { "grupo": 2, "sub_grupo": 1, "elemento": 4, "codigo": "2.1.4", "nome": "Salários a Pagar", "classificacao": "Passivo Circulante", "natureza": -1, "tipo": "A" },
    { "grupo": 2, "sub_grupo": 1, "elemento": 5, "codigo": "2.1.5", "nome": "Receitas Antecipadas", "classificacao": "Passivo Circulante", "natureza": -1, "tipo": "A" },
    { "grupo": 2, "sub_grupo": 1, "elemento": 6, "codigo": "2.1.6", "nome": "Dividendos a Pagar", "classificacao": "Passivo Circulante", "natureza": -1, "tipo": "A" },

    { "grupo": 2, "sub_grupo": 2, "elemento": 1, "codigo": "2.2.1", "nome": "Contas a Pagar LP", "classificacao": "Passivo Não Circulante", "natureza": -1, "tipo": "A" },
    { "grupo": 2, "sub_grupo": 2, "elemento": 2, "codigo": "2.2.2", "nome": "Fornecedores LP", "classificacao": "Passivo Não Circulante", "natureza": -1, "tipo": "A" },

    { "grupo": 3, "sub_grupo": 1, "elemento": 1, "codigo": "3.1.1", "nome": "Capital Social", "classificacao": "Patrimônio Líquido", "natureza": -1, "tipo": "A" },
    { "grupo": 3, "sub_grupo": 2, "elemento": 1, "codigo": "3.2.1", "nome": "Reserva de Lucros", "classificacao": "Patrimônio Líquido", "natureza": -1, "tipo": "A" },
    { "grupo": 3, "sub_grupo": 3, "elemento": 1, "codigo": "3.3.1", "nome": "Lucros Acumulados", "classificacao": "Patrimônio Líquido", "natureza": -1, "tipo": "A" },
    { "grupo": 3, "sub_grupo": 3, "elemento": 2, "codigo": "3.3.2", "nome": "Prejuízos Acumulados", "classificacao": "Patrimônio Líquido", "natureza": 1, "tipo": "A" },

    { "grupo": 4, "sub_grupo": 1, "elemento": 1, "codigo": "4.1.1", "nome": "Água/Luz", "classificacao": "Despesa Administrativa", "natureza": 1, "tipo": "A" },
    { "grupo": 4, "sub_grupo": 1, "elemento": 2, "codigo": "4.1.2", "nome": "Salários", "classificacao": "Despesa Administrativa", "natureza": 1, "tipo": "A" },
    { "grupo": 4, "sub_grupo": 1, "elemento": 3, "codigo": "4.1.3", "nome": "Despesa com Depreciação", "classificacao": "Despesa Administrativa", "natureza": 1, "tipo": "A" },
    { "grupo": 4, "sub_grupo": 1, "elemento": 4, "codigo": "4.1.4", "nome": "IRPJ/CSLL", "classificacao": "Despesa Administrativa", "natureza": 1, "tipo": "A" },
    { "grupo": 4, "sub_grupo": 1, "elemento": 5, "codigo": "4.1.5", "nome": "Impostos sobre venda", "classificacao": "Despesa Administrativa", "natureza": 1, "tipo": "A" },
    
    { "grupo": 4, "sub_grupo": 2, "elemento": 1, "codigo": "4.2.1", "nome": "CMV", "classificacao": "Custos", "natureza": 1, "tipo": "A" },
    { "grupo": 4, "sub_grupo": 2, "elemento": 2, "codigo": "4.2.2", "nome": "CPV", "classificacao": "Custos", "natureza": 1, "tipo": "A" },
    { "grupo": 4, "sub_grupo": 2, "elemento": 3, "codigo": "4.2.3", "nome": "CSP", "classificacao": "Custos", "natureza": 1, "tipo": "A" },
    
    { "grupo": 4, "sub_grupo": 3, "elemento": 1, "codigo": "4.3.1", "nome": "Despesa Financeira", "classificacao": "Despesa Financeira", "natureza": 1, "tipo": "A" },

    { "grupo": 5, "sub_grupo": 1, "elemento": 1, "codigo": "5.1.1", "nome": "Receita de Vendas", "classificacao": "Receita Operacional", "natureza": -1, "tipo": "A" },
    { "grupo": 5, "sub_grupo": 1, "elemento": 2, "codigo": "5.1.2", "nome": "Outras Receitas/Despesa Não Op.", "classificacao": "Receita Operacional", "natureza": -1, "tipo": "A" },
    { "grupo": 5, "sub_grupo": 2, "elemento": 1, "codigo": "5.2.1", "nome": "Receita Financeira", "classificacao": "Receita Financeira", "natureza": -1, "tipo": "A" },

    { "grupo": 6, "sub_grupo": 1, "elemento": 1, "codigo": "6.1.1", "nome": "ARE - Apuração de Resultado", "classificacao": "Transitória", "natureza": -1, "tipo": "A" }
];

        async function importar() {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = 'Limpando a tabela antiga...';
            // Limpa a tabela para garantir que apenas os dados novos existam
            await supabaseClient.from('plano_de_contas_padrao').delete().gt('natureza', -2);

            statusDiv.innerHTML = 'Iniciando importação...';
            console.log('Tentando inserir', contasPadrao.length, 'contas...');

            const { error } = await supabaseClient
                .from('plano_de_contas_padrao')
                .insert(contasPadrao);

            if (error) {
                statusDiv.innerHTML = `<strong>Erro na importação:</strong> ${error.message}`;
                console.error(error);
            } else {
                statusDiv.innerHTML = '<strong>Importação concluída com sucesso!</strong>. Você já pode apagar este arquivo.';
                console.log('Sucesso!');
            }
        }
        document.getElementById('start-import').addEventListener('click', importar);
    </script>
</body>
</html>